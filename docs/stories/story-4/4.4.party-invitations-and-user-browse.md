# Story 4.4: Party Invitations & User Browse (APIs + Frontend)

## Status

Draft

## Ownership

* **Primary Owner (Social Service APIs):** Minh Anh / An
* **Primary Owner (Frontend):** Duong

## Target Deadline

Thursday, 30/10/2025

## Story

**As a** Party Leader,
**I want** to browse users and send invitations or enable open join,
**so that** I can quickly recruit members into my party.

## Acceptance Criteria

1. Social Service APIs:
   - `GET /api/users?query=` — Returns paginated list of users (limited fields: id, displayName, class, level). Respect privacy settings.
   - `POST /api/parties/{partyId}/invites/send` — Send an invite to a specific `userId`. Only Party Leader can send.
   - `GET /api/parties/{partyId}/invites` — List pending invites.
   - `POST /api/parties/{partyId}/policy` — Update party policy: `{ openJoin: boolean }`.
2. Frontend pages/components:
   - `/social/party/invite` page with user search & invite action.
   - Components: UserSearchList, InviteActions, PendingInvitesList, PartyPolicyToggle.
3. Flow:
   - Leader searches users, sends invites; invited users receive invite entries retrievable by client later (actual notifications in a separate epic).
   - Leader toggles Open Join policy; join form (Story 4.3) reflects policy (shows “Open Join” banner if enabled).
4. Validation & Authorization:
   - Only Leader can send invites or toggle policy.
   - Invite duplicates are prevented; joining still requires capacity check.
5. OpenAPI docs updated; integration tests cover search/invite/policy endpoints.

## Tasks / Subtasks

- [ ] Task 1: APIs Implementation (AC: #1, #4, #5)
  - [ ] Build `GET /api/users` with pagination, query filter, and privacy compliance.
  - [ ] Implement party invite send/list endpoints with role checks and duplicate prevention.
  - [ ] Implement party policy update endpoint controlling `openJoin`.
- [ ] Task 2: Frontend Page & Components (AC: #2, #3)
  - [ ] Create `/social/party/invite` page with search and invite interactions.
  - [ ] Build UserSearchList, InviteActions, PendingInvitesList, PartyPolicyToggle.
- [ ] Task 3: Tests (AC: #5)
  - [ ] Integration tests for APIs; component tests for user search and invite flows.