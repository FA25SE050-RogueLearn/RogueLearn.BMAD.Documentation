# RougeLearn.BMAD.Documentation/docs/stories/1.1.project-infrastructure-setup.md
# **Story 1.1: project-infrastructure-setup**

## Status

Done

## Story

**As a** Developer,
**I want** to establish the foundational project infrastructure with proper CI/CD pipelines,
**so that** we have a reliable development and deployment foundation.

## Acceptance Criteria

1. Git repositories are created for the frontend and all backend microservices as defined in the architecture.
2. Basic "Hello World" or starter applications for both the Next.js frontend and .NET backend services are created and locally runnable.
3. A basic CI/CD pipeline is configured in GitHub Actions that triggers on commits to the `main` branch, runs tests, and builds the applications.
4. A basic structure for environment-specific configuration management (e.g., `.env` files for dev, staging, prod) is in place for all applications.
5. Docker containerization is set up for both the frontend and backend services, allowing them to be built and run as containers.
6. Basic logging infrastructure is configured in the backend services to output logs to the console.

## Tasks / Subtasks

- [x] **Task 1: Initialize Git Repositories** (AC: #1)
    - [x] Create a new Git repository for `roguelearn-web`.
    - [x] Create a new Git repository for `roguelearn-api` (this will be the backend monorepo).
    - [x] Create a new Git repository for `roguelearn-code-battle-service`.
    - [x] Create a new Git repository for `roguelearn-unity-games`.
- [x] **Task 2: Scaffold "Hello World" Applications** (AC: #2)
    - [x] In `roguelearn-web`, initialize a new Next.js 14.2.x application with TypeScript.
    - [x] In `roguelearn-api`, create a new .NET 8 solution (`.sln`).
    - [x] Inside `roguelearn-api`, create three separate .NET 8 Web API projects: `UserService`, `QuestsService`, `SocialService`.
    - [x] In `roguelearn-code-battle-service`, initialize a new Go application.
    - [x] In `roguelearn-unity-games`, initialize a new Unity 2022.3 LTS project.
    - [x] Ensure all applications can be run locally via CLI commands.
- [x] **Task 3: Implement Dockerization** (AC: #5)
    - [x] Create a `Dockerfile` for the `roguelearn-web` Next.js application.
    - [x] In `roguelearn-api`, create a `docker-compose.yml` that builds and runs all .NET services. Create individual `Dockerfile`s for each service project.
    - [x] **Subtask 3.1: Configure a `postgres` service within the `docker-compose.yml` file to provide a database for local development.**
    - [x] Ensure all Docker images can be built successfully and the application stack runs via `docker-compose up`.
- [x] **Task 4: Configure CI/CD Pipeline** (AC: #3)
    - [x] For each of the four repositories, create a `.github/workflows/ci.yml` file.
    - [x] Configure the GitHub Actions workflow to trigger on pushes to the `main` branch.
    - [x] Add steps to the workflow to install dependencies, run linters, execute tests, and build the Docker image(s).
    - [x] The `roguelearn-api` pipeline should be configured to build all .NET projects within the solution.
- [x] **Task 5: Setup Environment Configuration** (AC: #4)
    - [x] In `roguelearn-web`, create a `.env.example` file.
    - [x] In `roguelearn-api`, configure `appsettings.Development.json` and `appsettings.Production.json` placeholders for each service project.
    - [x] Ensure applications correctly load configuration based on the environment.
- [x] **Task 6: Configure Basic Logging** (AC: #6)
    - [x] In the .NET services within the `roguelearn-api` repo, ensure the default console logger is configured.

## Dev Notes

### **Repository Strategy**
The project follows a **Hybrid Monorepo/Multi-Repo Strategy**. This provides a balance between development velocity and separation of concerns. The following four repositories must be created:
- **`roguelearn-web`**: A standalone repository for the Next.js frontend application.
- **`roguelearn-api`**: A **monorepo** for all core .NET backend services. This will be a single .NET solution containing projects for the `UserService`, `QuestsService`, and `SocialService`.
- **`roguelearn-code-battle-service`**: A standalone repository for the specialized Go microservice for code execution.
- **`roguelearn-unity-games`**: A standalone repository for the Unity project for the "Boss Fight" game client.

*Note: Redis cache setup is deferred for post-MVP. The initial infrastructure will focus only on the required PostgreSQL database.*

### **Technology Stack**
- **Frontend:** Next.js `14.2.x`, TypeScript `5.4.x`
- **Backend (.NET):** .NET `8.0`, C# `12`
- **Backend (Go):** Go `1.22.x`
- **Game Engine:** Unity `2022.3 LTS`
- **CI/CD:** GitHub Actions
- **Containerization:** Docker

### **Testing Frameworks**
- **Frontend:** Jest & React Testing Library
- **Backend (.NET):** xUnit & Moq

### **Deployment Targets**
- **Frontend:** Vercel
- **Backend:** Azure Container Apps

### **Initial Setup Guidance**
- For the Next.js app, use `create-next-app`.
- For the backend monorepo, use `dotnet new sln` and then `dotnet new webapi` for each service project within the solution folder structure.
- For the Go service, set up a standard Go module structure.

## Change Log

| Date          | Version | Description        | Author     |
| :------------ | :------ | :----------------- | :--------- |
| [Current Date]| 1.2     | Set status to Done upon completion. | Sarah, PO |
| [Current Date]| 1.1     | Added PostgreSQL container setup to Task 3. Deferred Redis. Set status to Approved. | Sarah, PO |
| [Previous Date]| 1.0     | Initial story draft| Bob, SM    |


## Dev Agent Record

### Agent Model Used
_TBD by Dev Agent_

### Debug Log References
_TBD by Dev Agent_

### Completion Notes List
_TBD by Dev Agent_

### File List
_TBD by Dev Agent_

## QA Results
_TBD by QA Agent_