// RougeLearn.BMAD.Documentation/docs/stories/story-1/1.1.project-infrastructure-setup.md
# **Story 1.1: project-infrastructure-setup**

## Status

Done

## Story

**As a** Developer,
**I want** to establish the foundational project infrastructure with proper CI/CD pipelines,
**so that** we have a reliable development and deployment foundation.

## Acceptance Criteria

1. Git repositories are created for the frontend and all backend microservices as defined in the architecture.
2. Basic "Hello World" or starter applications for the Next.js frontend, .NET services, and Go services are created and locally runnable.
3. A basic CI/CD pipeline is configured in GitHub Actions for each repository that triggers on commits to the `main` branch, runs tests, and builds the applications.
4. A basic structure for environment-specific configuration management (e.g., `.env` files for dev, staging, prod) is in place for all applications.
5. Docker containerization is set up for both the frontend and all backend services, allowing them to be built and run as containers.
6. Basic logging infrastructure is configured in the backend services to output logs to the console.

## Tasks / Subtasks

- [x] **Task 1: Initialize Git Repositories** (AC: #1)
    - [x] Create repositories for `RogueLearn.Frontend`, `RogueLearn.User`, `RogueLearn.CodeBattle`, `roguelearn-unity-games`, `RogueLearn.Protos`, and `RogueLearn.Kubernetes`.
    - [x] Initialize the `RogueLearn.CleanArchitecture` repository with the .NET template.
    - [x] Create placeholder repositories for `RogueLearn.Quests`, `RogueLearn.Social`, and `RogueLearn.Meeting` to be developed later.
- [x] **Task 2: Scaffold "Hello World" Applications** (AC: #2)
    - [x] In `RogueLearn.Frontend`, initialize a new Next.js 14.2.x application with TypeScript.
    - [x] In `RogueLearn.User`, create a new .NET 8 Web API project using the `RogueLearn.CleanArchitecture` template.
    - [x] In `RogueLearn.CodeBattle`, initialize a new Go application with a basic HTTP server.
    - [x] In `roguelearn-unity-games`, initialize a new Unity 2022.3 LTS project.
    - [x] Ensure all initial applications can be run locally via their respective CLI commands.
- [x] **Task 3: Implement Dockerization** (AC: #5)
    - [x] Create a `Dockerfile` in the `RogueLearn.Frontend` repository.
    - [x] Create a `Dockerfile` in the `RogueLearn.User` repository.
    - [x] Create a `Dockerfile` in the `RogueLearn.CodeBattle` repository.
    - [x] Create a root-level `docker-compose.yml` (potentially in the `RogueLearn.Kubernetes` repo or a new `dev-environment` repo) that builds and runs all services, including a `postgres` service for the shared database.
    - [x] Ensure all Docker images can be built successfully and the application stack runs via `docker-compose up`.
- [x] **Task 4: Configure CI/CD Pipeline** (AC: #3)
    - [x] For each active repository (`RogueLearn.Frontend`, `RogueLearn.User`, `RogueLearn.CodeBattle`), create a `.github/workflows/ci.yml` file.
    - [x] Configure the GitHub Actions workflow to trigger on pushes to the `main` branch.
    - [x] Add steps to the workflow to install dependencies, run linters, execute tests, and build the Docker image.
- [x] **Task 5: Setup Environment Configuration** (AC: #4)
    - [x] In `RogueLearn.Frontend`, create a `.env.example` file.
    - [x] In `RogueLearn.User`, configure `appsettings.Development.json` and `appsettings.Production.json` placeholders.
    - [x] In `RogueLearn.CodeBattle`, establish a convention for loading environment variables (e.g., from a `.env` file).
    - [x] Ensure applications correctly load configuration based on the environment.
- [x] **Task 6: Configure Basic Logging** (AC: #6)
    - [x] In the `RogueLearn.User` service, ensure the default console logger is configured.
    - [x] In the `RogueLearn.CodeBattle` service, implement basic structured logging to `stdout`.

## Dev Notes

### **Repository Strategy**
The project follows a pure **Multi-Repo Strategy**. Each microservice, application, and shared component has its own dedicated repository to enforce strict separation of concerns and enable independent deployment pipelines.

*Source: `docs/fullstack-architecture/high-level-architecture.md`*

### **Technology Stack**
- **Frontend:** Next.js `14.2.x`, TypeScript `5.4.x`
- **Backend (.NET):** .NET `8.0`, C# `12`
- **Backend (Go):** Go `1.22.x`
- **Game Engine:** Unity `2022.3 LTS`
- **CI/CD:** GitHub Actions
- **Containerization:** Docker

### **Testing Frameworks**
- **Frontend:** Jest & React Testing Library
- **Backend (.NET):** xUnit & Moq

### **Deployment Targets**
- **Frontend:** Vercel
- **Backend:** Azure Container Apps via Kubernetes/ArgoCD

### **Initial Setup Guidance**
- New .NET services should be bootstrapped by cloning the `RogueLearn.CleanArchitecture` template repository.
- A root-level `docker-compose.yml` should be used to orchestrate the local development environment across all repositories.

## Change Log

| Date          | Version | Description        | Author     |
| :------------ | :------ | :----------------- | :--------- |
| [Current Date]| 1.2     | Set status to Done upon completion. | Sarah, PO |
| [Current Date]| 1.1     | Added PostgreSQL container setup to Task 3. Deferred Redis. Set status to Approved. | Sarah, PO |
| [Previous Date]| 1.0     | Initial story draft| Bob, SM    |


## Dev Agent Record

### Agent Model Used
_TBD by Dev Agent_

### Debug Log References
_TBD by Dev Agent_

### Completion Notes List
_TBD by Dev Agent_

### File List
_TBD by Dev Agent_

## QA Results
_TBD by QA Agent_