@startuml
actor Admin
participant AdminManagementUI as UI
participant ":SubjectsController" as Controller
participant ":IMediator" as Med
participant ":RemoveSubjectSkillMapping\nCommandHandler" as Handler
participant ":ISubjectSkillMapping\nRepository" as IMapRepo
participant ":SubjectSkillMapping\nRepository" as MapRepo
database ":Database" as DB

Admin -> UI : Click "Remove" on Mapping
activate UI

UI -> Controller : DELETE /subjects/{sid}/skills/{kid}
activate Controller

Controller -> Med : Send(RemoveSubjectSkillMappingCommand)
activate Med

Med -> Handler : Handle(command)
activate Handler

' 1. Find Mapping
Handler -> IMapRepo : FirstOrDefaultAsync(SubjectId, SkillId)
activate IMapRepo
IMapRepo -> MapRepo : FirstOrDefaultAsync(SubjectId, SkillId)
activate MapRepo
MapRepo -> DB : SELECT * FROM subject_skill_mappings...
activate DB
DB --> MapRepo : Mapping?
deactivate DB
MapRepo --> IMapRepo : Mapping?
deactivate MapRepo
IMapRepo --> Handler : Mapping?
deactivate IMapRepo

alt Not Found
    Handler --> Med : Throw NotFoundException
else Found
    ' 2. Delete
    Handler -> IMapRepo : DeleteAsync(MappingId)
    activate IMapRepo
    IMapRepo -> MapRepo : DeleteAsync(MappingId)
    activate MapRepo
    MapRepo -> DB : DELETE FROM subject_skill_mappings...
    activate DB
    DB --> MapRepo : Success
    deactivate DB
    MapRepo --> IMapRepo : Success
    deactivate MapRepo
    IMapRepo --> Handler : Success
    deactivate IMapRepo
    
    Handler --> Med : Unit.Value
end

deactivate Handler
Med --> Controller : Success
deactivate Med

Controller --> UI : 204 No Content
deactivate Controller

UI -> UI : Remove Item from List
UI --> Admin : Show "Mapping Removed" Success
deactivate UI
@enduml