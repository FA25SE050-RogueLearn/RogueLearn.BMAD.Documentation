@startuml
actor Admin
participant ":AdminSkillsController" as Controller
participant ":IMediator" as Med
participant ":AddSkillDependency\nHandler" as Handler
participant ":ISkillDependency\nRepository" as DepRepo
database ":Database" as DB

Admin -> Controller : POST /skills/{id}/dependencies
activate Controller

Controller -> Med : Send(AddSkillDependencyCommand)
activate Med

Med -> Handler : Handle(command)
activate Handler

' 1. Validate
Handler -> Handler : Validate SkillId != PrereqId

' 2. Check Exists
Handler -> DepRepo : AnyAsync(SkillId, PrereqId)
activate DepRepo
DepRepo -> DB : SELECT 1...
DB --> DepRepo : Exists?
deactivate DepRepo

alt Exists
    Handler --> Med : Throw ConflictException
else New Dependency
    ' 3. Create
    Handler -> DepRepo : AddAsync(Dependency)
    activate DepRepo
    DepRepo -> DB : INSERT INTO skill_dependencies...
    DB --> DepRepo : Success
    deactivate DepRepo
    
    Handler --> Med : CreatedDto
end

deactivate Handler
Med --> Controller : Response
deactivate Med

Controller --> Admin : 201 Created
deactivate Controller
@enduml