' curriculum-management-seq.puml
@startuml
actor Admin
participant "Admin Dashboard" as UI
participant "CurriculumImport\nController" as Controller
participant "ImportCurriculum\nHandler" as Handler
participant "HtmlCleaning\nService" as Cleaner
participant "CurriculumExtraction\nPlugin (AI)" as AI
participant "Database" as DB

Admin -> UI : 1. Upload Curriculum HTML
UI -> Controller : 2. Request Import (POST)
Controller -> Handler : 3. Handle(command)

activate Handler
    Handler -> Cleaner : 4. ExtractCleanText(html)
    Cleaner --> Handler : Cleaned Text
    
    Handler -> AI : 5. ExtractCurriculumJsonAsync(text)
    AI -> AI : Call Gemini AI
    AI --> Handler : CurriculumData JSON
    
    Handler -> DB : 6. Create/Update CurriculumProgram
    
    loop For Each Subject in JSON
        Handler -> DB : 7. Find or Create Subject
        Handler -> DB : 8. Link Subject to Program
        note right: Create CurriculumProgramSubject record
    end
    
    Handler --> Controller : 9. Return Success
deactivate Handler

Controller --> UI : 10. 200 OK
UI --> Admin : 11. Show "Import Completed"
@enduml