@startuml
actor Admin
participant ":SubjectsController" as Controller
participant ":IMediator" as Med
participant ":GetAllSubjectsHandler" as Handler
participant ":ISubjectRepository" as IRepo
participant ":SubjectRepository" as Repo
database ":Database" as DB

Admin -> Controller : GET /api/admin/subjects?page=1...
activate Controller

Controller -> Med : Send(GetAllSubjectsQuery)
activate Med

Med -> Handler : Handle(query)
activate Handler

Handler -> IRepo : GetPagedSubjectsAsync(Search, Page, Size)
activate IRepo
IRepo -> Repo : GetPagedSubjectsAsync(Search, Page, Size)
activate Repo
Repo -> DB : SELECT * FROM subjects...
activate DB
DB --> Repo : List<Subject>, TotalCount
deactivate DB
Repo --> IRepo : List<Subject>, TotalCount
deactivate Repo
IRepo --> Handler : List<Subject>, TotalCount
deactivate IRepo

Handler -> Handler : Map to DTOs

Handler --> Med : PaginatedSubjectsResponse
deactivate Handler

Med --> Controller : Response
deactivate Med

Controller --> Admin : 200 OK
deactivate Controller
@enduml