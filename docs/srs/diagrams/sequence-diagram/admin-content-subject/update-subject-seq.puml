@startuml
actor Admin
participant AdminManagementUI as UI
participant ":SubjectsController" as Controller
participant ":IMediator" as Med
participant ":UpdateSubjectHandler" as Handler
participant ":ISubjectRepository" as IRepo
participant ":SubjectRepository" as Repo
database ":Database" as DB

Admin -> UI : Edit Subject Details & Click "Update"
activate UI

UI -> Controller : PUT /api/admin/subjects/{id}
activate Controller

Controller -> Med : Send(UpdateSubjectCommand)
activate Med

Med -> Handler : Handle(command)
activate Handler

' 1. Fetch
Handler -> IRepo : GetByIdAsync(Id)
activate IRepo
IRepo -> Repo : GetByIdAsync(Id)
activate Repo
Repo -> DB : SELECT * ...
activate DB
DB --> Repo : Subject?
deactivate DB
Repo --> IRepo : Subject?
deactivate Repo
IRepo --> Handler : Subject?
deactivate IRepo

alt Not Found
    Handler --> Med : Throw NotFoundException
else Found
    ' 2. Update
    Handler -> Handler : Update Properties
    Handler -> IRepo : UpdateAsync(Subject)
    activate IRepo
    IRepo -> Repo : UpdateAsync(Subject)
    activate Repo
    Repo -> DB : UPDATE subjects...
    activate DB
    DB --> Repo : Success
    deactivate DB
    Repo --> IRepo : UpdatedEntity
    deactivate Repo
    IRepo --> Handler : UpdatedEntity
    deactivate IRepo
    
    Handler --> Med : UpdateSubjectResponse
end

deactivate Handler
Med --> Controller : Response
deactivate Med

Controller --> UI : 200 OK
deactivate Controller

UI -> UI : Refresh Subject Details
UI --> Admin : Show "Subject Updated" Success
deactivate UI
@enduml