' process-academic-record-class.puml
@startuml
skinparam linetype ortho
skinparam ranksep 50
skinparam nodesep 50
skinparam classAttributeIconSize 0
hide empty members

package "API Layer" {
    class UsersController {
        +ProcessMyAcademicRecord()
    }
}

package "Application Layer" {
    class ProcessAcademicRecordCommand {
        +AuthUserId
        +HtmlContent
        +ProgramId
    }

    class ProcessAcademicRecordHandler {
        +Handle()
    }

    interface IHtmlCleaningService {
        +ExtractCleanText()
    }

    interface IFapExtractionPlugin {
        +ExtractFapRecordJsonAsync()
    }
}

package "Domain & Infrastructure Layer" {
    class HtmlCleaningService
    class FapExtractionPlugin
    
    interface IStudentSemesterSubjectRepository
    interface ISubjectRepository
    class CurriculumImportStorage
    
    class StudentSemesterSubject {
        +Status
        +Grade
    }
}

' Formatting: Force vertical layers
UsersController -[hidden]- ProcessAcademicRecordCommand
ProcessAcademicRecordCommand -[hidden]- IHtmlCleaningService

' Relationships
UsersController ..> ProcessAcademicRecordCommand : Creates
UsersController ..> ProcessAcademicRecordHandler : Sends

ProcessAcademicRecordHandler ..> ProcessAcademicRecordCommand : Uses
ProcessAcademicRecordHandler --> IHtmlCleaningService
ProcessAcademicRecordHandler --> IFapExtractionPlugin
ProcessAcademicRecordHandler --> IStudentSemesterSubjectRepository
ProcessAcademicRecordHandler --> ISubjectRepository
ProcessAcademicRecordHandler --> CurriculumImportStorage

IHtmlCleaningService <|.. HtmlCleaningService
IFapExtractionPlugin <|.. FapExtractionPlugin
IStudentSemesterSubjectRepository ..> StudentSemesterSubject : Manages

@enduml